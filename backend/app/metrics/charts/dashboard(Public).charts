{"exportVersion":8,"dashboards":{"dashboard-1":{"title":"Users Dashboard (Public)","layout":[{"w":1,"h":1,"x":0,"y":0,"i":"item-1"},{"w":4,"h":3,"x":2,"y":0,"i":"item-2"},{"w":3,"h":3,"x":6,"y":0,"i":"item-3"},{"w":2,"h":1,"x":0,"y":2,"i":"item-4"},{"w":2,"h":1,"x":0,"y":1,"i":"item-5"},{"w":1,"h":1,"x":1,"y":0,"i":"item-6"},{"w":7,"h":2,"x":2,"y":3,"i":"item-7"},{"w":2,"h":1,"x":0,"y":3,"i":"item-8"},{"w":2,"h":1,"x":0,"y":4,"i":"item-9"},{"w":2,"h":1,"x":0,"y":5,"i":"item-10"},{"w":2,"h":1,"x":0,"y":6,"i":"item-11"},{"w":2,"h":1,"x":0,"y":7,"i":"item-12"},{"w":7,"h":2,"x":2,"y":5,"i":"item-13"},{"w":7,"h":2,"x":2,"y":7,"i":"item-14"}],"description":"Information about who our users are.","embedding":{},"filters":[{"disabled":false,"type":"Date","settings":{"type":"relative","absolute":{"from":{"enabled":false,"time":"00:00:00","inclusive":false},"to":{"enabled":false,"time":"00:00:00","inclusive":false}},"relative":{"from":{"enabled":true,"value":"2","tense":"last","unit":"weeks"},"until":{"enabled":false,"value":""}},"period":{"direction":"previous","count":"1","unit":"month","includeCurrent":true}},"name":"timestamp","linkedFields":[{"dataSourceId":"data-source-1","fieldPath":"timestamp"}]}]}},"items":{"item-13":{"title":"Drop-off breakdown by Conversation Phase (absolute)","description":"Number of users who started a conversation, broken down by the phase where they dropped off","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"combo-stacked","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[],"channels":{"x":{"field":"timestamp","type":"nominal","inferredType":"Date","channelType":"category","isBinning":true,"temporalBinning":["year","month","date"]},"y":{"field":"ENDED","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"y_series_0":{"field":"DIVE_IN","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"y_series_1":{"field":"COLLECT_EXPERIENCES","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"y_series_2":{"field":"INTRO","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"ylines":{"field":"_DROPOUT","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"}},"reductions":{},"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":{"range":["#16cc62","#196ee6","#E6B219","#e6196e","#000000"],"domain":["y","y_series_0","y_series_1","y_series_2","ylines"]}},"dashStyles":{"enabled":true,"value":null},"lineSmoothing":{"enabled":true,"value":"monotone"},"dataMarkers":{"enabled":true,"value":null},"dataValueLabels":{"enabled":true,"value":null},"labelSize":{"enabled":true,"value":"109"}},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"diagonal"}},"y":{"labelOverride":{"enabled":true,"value":"Number of Users"}}},"channels":{"x":{"labelOverride":{"enabled":true,"value":"Date"},"datePreset":{"enabled":true,"value":"Custom"},"dateTimeFormatting":{"enabled":true,"value":"ddd-DD-MMM"}},"y":{"labelOverride":{"enabled":true,"value":"ENDED"},"numberFormatting":{"enabled":true,"value":"Custom"}},"y_series_0":{"labelOverride":{"enabled":true,"value":"DIVE_IN"},"numberFormatting":{"enabled":true,"value":"Default"}},"y_series_1":{"labelOverride":{"enabled":true,"value":"COLLECT_EXPERIENCES"},"numberFormatting":{"enabled":true,"value":"Default"}},"y_series_2":{"labelOverride":{"enabled":true,"value":"INTRO"},"numberFormatting":{"enabled":true,"value":"Default"}},"ylines":{"labelOverride":{"enabled":true,"value":"users who started but didnâ€™t finish"},"numberFormatting":{"enabled":true,"value":"Custom"},"numberGrouping":{"enabled":false,"value":null},"numberDecimals":{"enabled":true,"value":"0"},"numberPrefix":{"enabled":true,"value":""},"numberSuffix":{"enabled":true,"value":"         `"}}},"conditionalFormatting":[]},"chartType":"Stacked Combo","meta":{},"sample":false,"query":"[\n  {\n    $match: {\n      event_type: 100002,\n      phase: { $in: [\"INTRO\", \"COLLECT_EXPERIENCES\", \"DIVE_IN\", \"ENDED\"] }\n    }\n  },\n  {\n    $addFields: {\n      date: { $dateTrunc: { date: \"$timestamp\", unit: \"day\" } },\n      phaseOrder: {\n        $switch: {\n          branches: [\n            { case: { $eq: [\"$phase\", \"INTRO\"] }, then: 1 },\n            { case: { $eq: [\"$phase\", \"COLLECT_EXPERIENCES\"] }, then: 2 },\n            { case: { $eq: [\"$phase\", \"DIVE_IN\"] }, then: 3 },\n            { case: { $eq: [\"$phase\", \"ENDED\"] }, then: 4 }\n          ],\n          default: 99\n        }\n      }\n    }\n  },\n  {\n    $sort: {\n      anonymized_user_id: 1,\n      date: 1,\n      phaseOrder: -1\n    }\n  },\n  {\n    $group: {\n      _id: {\n        session: \"$anonymized_session_id\",\n        date: \"$date\"\n      },\n      lastPhase: { $first: \"$phase\" }\n    }\n  },\n  {\n    $addFields: {\n      phase_label_ordered: {\n        $switch: {\n          branches: [\n            { case: { $eq: [\"$lastPhase\", \"INTRO\"] }, then: \"4_INTRO\" },\n            { case: { $eq: [\"$lastPhase\", \"COLLECT_EXPERIENCES\"] }, then: \"3_COLLECT_EXPERIENCES\" },\n            { case: { $eq: [\"$lastPhase\", \"DIVE_IN\"] }, then: \"2_DIVE_IN\" },\n            { case: { $eq: [\"$lastPhase\", \"ENDED\"] }, then: \"1_ENDED\" }\n          ],\n          default: \"0_UNKNOWN\"\n        }\n      }\n    }\n  },\n  {\n    $group: {\n      _id: {\n        date: \"$_id.date\",\n        phase: \"$phase_label_ordered\"\n      },\n      sessionCount: { $sum: 1 }\n    }\n  },\n  {\n    $group: {\n      _id: \"$_id.date\",\n      phases: {\n        $push: {\n          k: \"$_id.phase\",\n          v: \"$sessionCount\"\n        }\n      }\n    }\n  },\n  {\n    $addFields: {\n      phaseCounts: { $arrayToObject: \"$phases\" }\n    }\n  },\n  {\n    $addFields: {\n      total: {\n        $reduce: {\n          input: { $objectToArray: \"$phaseCounts\" },\n          initialValue: 0,\n          in: { $add: [\"$$value\", \"$$this.v\"] }\n        }\n      }\n    }\n  },\n  {\n    $project: {\n      timestamp: \"$_id\",\n      INTRO: { $getField: { field: \"4_INTRO\", input: \"$phaseCounts\" } },\n      COLLECT_EXPERIENCES: { $getField: { field: \"3_COLLECT_EXPERIENCES\", input: \"$phaseCounts\" } },\n      DIVE_IN: { $getField: { field: \"2_DIVE_IN\", input: \"$phaseCounts\" } },\n      ENDED: { $getField: { field: \"1_ENDED\", input: \"$phaseCounts\" } },\n      _DROPOUT: {\n        $subtract: [\n          \"$total\",\n          { $ifNull: [{ $getField: { field: \"1_ENDED\", input: \"$phaseCounts\" } }, 0] }\n        ]\n      }\n    }\n  },\n  {\n    $sort: { timestamp: 1 }\n  }\n]","queryId":null,"interactiveFiltering":"highlight","embedding":{}},"item-1":{"title":"Users Registered","description":"","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"number","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[],"channels":{"value":{"field":"_id","type":"quantitative","inferredType":"String","channelType":"aggregation","aggregate":"distinct"}},"reductions":{},"customisations":{"options":{},"axes":{},"channels":{"value":{"labelOverride":{"enabled":true,"value":"Unique Users"},"numberFormatting":{"enabled":true,"value":"Default"}}},"conditionalFormatting":[{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_GREATER_THAN_OR_EQUAL_TO","value":"20"}],"applyToEntireRow":false,"styling":{"color":"rgb(45, 134, 82)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}},{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_LESS_THAN","value":"20"}],"applyToEntireRow":false,"styling":{"color":"rgb(193, 4, 34)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}}]},"chartType":"Number","meta":{},"sample":false,"query":"{ event_type: 100001 }","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-3":{"title":"Location","description":"of users who chose to share it :)","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"geo-heatmap","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[],"channels":{"geopoint":{"field":"coordinates","type":"geospatial_array","inferredType":"Number","channelType":"geopoint"},"intensity":{"field":"_id","type":"quantitative","inferredType":"String","channelType":"aggregation","aggregate":"count"}},"reductions":{},"customisations":{"options":{"legendPosition":{"enabled":true,"value":"bottom"}},"axes":{},"channels":{"geopoint":{},"intensity":{"labelOverride":{"enabled":true,"value":"No. of Users"},"numberFormatting":{"enabled":true,"value":"Default"}}},"conditionalFormatting":[]},"chartType":"Geospatial Heatmap","meta":{"viewport":{"center":[28.22697003891834,-19.423828125000004],"zoom":3},"legends":{"min":1,"max":142},"indexes":{"channel":"geopoint","indexLat":0,"indexLong":1}},"sample":false,"query":"{ event_type: 200003 }","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-4":{"title":"Browser Type","description":"","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"donut","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[{"fieldPath":"normalized_browser_type","rawExpression":"{ \"$toLower\": { \"$ifNull\": [ \"$browser_type\", \"UNKNOWN\" ] } }","derivedMQL":"{\"$toLower\":{\"$ifNull\":[\"$browser_type\",\"UNKNOWN\"]}}"}],"channels":{"value":{"field":"_id","type":"quantitative","inferredType":"String","channelType":"aggregation","aggregate":"count"},"label":{"field":"normalized_browser_type","type":"nominal","inferredType":"String","channelType":"category","isBinning":false,"sort":{"axis":"Aggregated Value","order":"descending"},"allOthers":true}},"reductions":{},"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":{"range":["#16CC62","#196EE6","#E6B219","#E6196E","#116149","#19C3E6","#E65D19","#C10422","#1392AB","#8A27A5"],"domain":["chrome","edge","safari","samsung internet","firefox","opera","unknown","brave","mobile safari","miui browser"]}},"dataCategoryLabels":{"enabled":true,"value":null},"dataValueLabels":{"enabled":true,"value":"percentage"},"labelSize":{"enabled":true,"value":"150"}},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Default"}},"label":{"labelOverride":{"enabled":true,"value":"Browser Type"}}},"conditionalFormatting":[]},"chartType":"Donut","meta":{"legends":{"min":1,"max":17}},"sample":false,"query":"{event_type: 200004}","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-2":{"title":"Unique Users Registered Over Time","description":"","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"line-discrete","itemType":"chart","filters":[{"fieldPath":"timestamp","disabled":false,"type":"Date","settings":{"type":"relative","absolute":{"from":{"enabled":true,"date":"2025-03-02","time":"00:00:00","inclusive":true},"to":{"enabled":false,"time":"00:00:00","inclusive":false}},"relative":{"from":{"enabled":true,"value":"30","tense":"last","unit":"days"},"until":{"enabled":false,"value":""}},"period":{"direction":"previous","count":"1","unit":"month","includeCurrent":true}}}],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[],"channels":{"x":{"field":"timestamp","type":"nominal","inferredType":"Date","channelType":"category","isBinning":true,"temporalBinning":["year","month","date"]},"y":{"field":"_id","type":"quantitative","inferredType":"String","channelType":"aggregation","aggregate":"distinct"}},"reductions":{},"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":["#16CC62"]},"lineSmoothing":{"enabled":true,"value":"step-before"}},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"horizontal"}},"y":{}},"channels":{"x":{"labelOverride":{"enabled":true,"value":"Date Created"},"datePreset":{"enabled":true,"value":"Custom"},"dateTimeFormatting":{"enabled":true,"value":"DD-MMM"}},"y":{"labelOverride":{"enabled":true,"value":"Unique Users"},"numberFormatting":{"enabled":true,"value":"Default"}}},"conditionalFormatting":[]},"chartType":"Line","meta":{},"sample":false,"query":"{ event_type: 100001 }","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-5":{"title":"Device Type","description":"","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"donut","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[{"fieldPath":"normalized_device_type","rawExpression":"{ \"$toLower\": \"$device_type\" }\n","derivedMQL":"{\"$toLower\":\"$device_type\"}"}],"channels":{"value":{"field":"_id","type":"quantitative","inferredType":"String","channelType":"aggregation","aggregate":"count"},"label":{"field":"normalized_device_type","type":"nominal","inferredType":"String","channelType":"category","isBinning":false,"allOthers":true}},"reductions":{},"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":{"range":["#16CC62","#196EE6","#E6B219"],"domain":["mobile","browser","tablet"]}},"dataCategoryLabels":{"enabled":true,"value":null},"dataValueLabels":{"enabled":true,"value":"percentage"},"labelSize":{"enabled":true,"value":"149"}},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Default"}},"label":{"labelOverride":{"enabled":true,"value":"Device Type"}}},"conditionalFormatting":[]},"chartType":"Donut","meta":{"legends":{"min":1,"max":17}},"sample":false,"query":"{event_type: 200004}","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-6":{"title":"Number of users","description":"who shared location","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"number","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[],"channels":{"value":{"field":"coordinates","type":"quantitative","inferredType":"Number","transformedType":"Number","channelType":"aggregation","aggregate":"count"}},"reductions":{"value":[{"dimensionality":1,"field":"coordinates","type":"Array length","arguments":[0]}]},"customisations":{"options":{},"axes":{},"channels":{"value":{"labelOverride":{"enabled":true,"value":"Unique Users"},"numberFormatting":{"enabled":true,"value":"Custom"}}},"conditionalFormatting":[]},"chartType":"Number","meta":{},"sample":false,"query":"{ event_type: 200003 }","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-7":{"title":"Dropoff Percentage","description":"Users who registered but didn't complete a conversation","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"line-discrete","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[],"channels":{"y":{"field":"dropoutPercentage","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"mean"},"x":{"field":"timestamp","type":"nominal","inferredType":"Date","channelType":"category","isBinning":true,"temporalBinning":["year","month","date"]}},"reductions":{},"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":["#c10422"]},"lineSmoothing":{"enabled":true,"value":"monotone"},"dataMarkers":{"enabled":true,"value":null},"dataValueLabels":{"enabled":true,"value":null}},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"diagonal"}},"y":{}},"channels":{"y":{"labelOverride":{"enabled":true,"value":"Dropoff percentage"},"numberFormatting":{"enabled":true,"value":"Custom"},"numberDecimals":{"enabled":true,"value":"2"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}},"x":{"labelOverride":{"enabled":true,"value":"Date"},"datePreset":{"enabled":true,"value":"Custom"},"dateTimeFormatting":{"enabled":true,"value":"ddd-DD-MMM"}}},"conditionalFormatting":[]},"chartType":"Line","meta":{},"sample":false,"query":"[\n  {\n    $match: {\n      event_type: { $in: [100001, 100002] }\n    }\n  },\n  {\n    $addFields: {\n      isCreated: { $cond: [{ $eq: [\"$event_type\", 100001] }, 1, 0] },\n      isEnded: {\n        $cond: [\n          {\n            $and: [\n              { $eq: [\"$event_type\", 100002] },\n              { $eq: [\"$phase\", \"ENDED\"] }\n            ]\n          },\n          1,\n          0\n        ]\n      }\n    }\n  },\n  {\n    $group: {\n      _id: {\n        $dateTrunc: {\n          date: \"$timestamp\",\n          unit: \"day\" // You can change this to \"hour\", \"week\", etc.\n        }\n      },\n      totalCreated: { $sum: \"$isCreated\" },\n      totalEnded: { $sum: \"$isEnded\" }\n    }\n  },\n  {\n    $addFields: {\n      dropoutPercentage: {\n        $cond: [\n          { $eq: [\"$totalCreated\", 0] },\n          null,\n          { $subtract: [1, { $divide: [\"$totalEnded\", \"$totalCreated\"] }] }\n        ]\n      },\n      timestamp: \"$_id\" // Expose the truncated timestamp explicitly\n    }\n  }\n]","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-9":{"title":"Concluded Conversations","description":"","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"number","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[],"channels":{"value":{"field":"phase","type":"quantitative","inferredType":"String","channelType":"aggregation","aggregate":"count"}},"reductions":{},"customisations":{"options":{},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Default"}}},"conditionalFormatting":[]},"chartType":"Number","meta":{},"sample":false,"query":"{ event_type: 100002, phase: \"ENDED\" }","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-8":{"title":"Overall Dropout percentage","description":"","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"number","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[{"fieldPath":"dropout","rawExpression":"{ $subtract: [1, { $divide: [\"$totalUserConcludedConversation\", \"$totalUserCreatedAccount\"] }] }\n","derivedMQL":"{\"$subtract\":[1,{\"$divide\":[\"$totalUserConcludedConversation\",\"$totalUserCreatedAccount\"]}]}"}],"channels":{"value":{"field":"dropout","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"}},"reductions":{},"customisations":{"options":{},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Custom"},"numberDecimals":{"enabled":true,"value":"1"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}}},"conditionalFormatting":[{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_GREATER_THAN","value":"0.5"}],"applyToEntireRow":false,"styling":{"color":"rgb(193, 4, 34)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}},{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_LESS_THAN","value":"0.05"}],"applyToEntireRow":false,"styling":{"color":"rgb(22, 204, 98)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}}]},"chartType":"Number","meta":{},"sample":false,"query":"[\n  {\n    $match: {\n      event_type: { $in: [100001, 100002] } // get the events that are either user created or conversation phase changed\n    }\n  },\n  {\n    $group: {\n      _id: null, \n      totalUserCreatedAccount: {\n        $sum: { $cond: [{ $eq: [\"$event_type\", 100001] }, 1, 0] } // get the sum of all entries that are user created\n      },\n      totalUserConcludedConversation: {\n        $sum: {\n          $cond: [\n            {\n              $and: [\n                { $eq: [\"$event_type\", 100002] },\n                { $eq: [\"$phase\", \"ENDED\"] } // get the sum of all entries that  have an \"ENDED\" phase\n              ]\n            },\n            1,\n            0\n          ]\n        }\n      }\n    }\n  }\n]","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-10":{"title":"Users dropped&nbsp;","description":"before Starting a conversation","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"number","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[{"fieldPath":"droppedBeforeStarting","rawExpression":"{ $subtract: [1, {\n  $divide: ['$usersWithConversation', '$usersCreated']\n}]}\n\n","derivedMQL":"{\"$subtract\":[1,{\"$divide\":[\"$usersWithConversation\",\"$usersCreated\"]}]}"}],"channels":{"value":{"field":"droppedBeforeStarting","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"}},"reductions":{},"customisations":{"options":{},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Custom"},"numberDecimals":{"enabled":true,"value":"2"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}}},"conditionalFormatting":[{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_GREATER_THAN","value":"0.1"}],"applyToEntireRow":false,"styling":{"color":"rgb(193, 4, 34)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}},{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_LESS_THAN","value":"0.05"}],"applyToEntireRow":false,"styling":{"color":"rgb(22, 204, 98)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}}]},"chartType":"Number","meta":{},"sample":false,"query":"[\n  {\n    $match: {\n      event_type: { $in: [100001, 100002] } // get the relevant events\n    }\n  },\n  {\n    $group: {\n      _id: \"$anonymized_user_id\", // Group by user to track if they have an event of interest\n      hasUserCreatedEvent: {\n        $sum: { $cond: [{ $eq: [\"$event_type\", 100001] }, 1, 0] } // sum all the created events for a user\n      },\n      hasIntroConversationPhaseEvent: {\n        $sum: {\n          $cond: [\n            {\n              $and: [\n                { $eq: [\"$event_type\", 100002] }, //  sum all the phase events\n                { $eq: [\"$phase\", \"INTRO\"] } //  that have \"INTRO\" type\n              ]\n            },\n            1,\n            0\n          ]\n        }\n      }\n    }\n  },\n  {\n    $group: {\n      _id: null,\n      usersCreated: { $sum: 1 }, // add all the created events (one per user)\n      usersWithConversation: {\n        $sum: { $cond: [{ $gt: [\"$hasIntroConversationPhaseEvent\", 0] }, 1, 0] } // if there is an INTRO phase event for a user, count the user\n      }\n    }\n  }\n]","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-12":{"title":"Users dropped&nbsp;","description":"before Exploring any Experiences","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"number","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[{"fieldPath":"droppedBeforeExperience","rawExpression":"{ $subtract: [1, {\n  $divide: ['$usersWithExperienceExplored', '$usersCreated']\n}]}\n\n","derivedMQL":"{\"$subtract\":[1,{\"$divide\":[\"$usersWithExperienceExplored\",\"$usersCreated\"]}]}"}],"channels":{"value":{"field":"droppedBeforeExperience","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"}},"reductions":{},"customisations":{"options":{},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Percentage"},"numberDecimals":{"enabled":true,"value":"2"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}}},"conditionalFormatting":[{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_GREATER_THAN","value":"0.35"}],"applyToEntireRow":false,"styling":{"color":"rgb(193, 4, 34)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}},{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_LESS_THAN","value":"0.1"}],"applyToEntireRow":false,"styling":{"color":"rgb(22, 204, 98)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}}]},"chartType":"Number","meta":{},"sample":false,"query":"[\n  {\n    $match: {\n      event_type: { $in: [100001, 100008] }\n    }\n  },\n  {\n    $group: {\n      _id: \"$anonymized_user_id\",\n      hasUserCreatedEvent: {\n        $sum: {\n          $cond: [{ $eq: [\"$event_type\", 100001] }, 1, 0]\n        }\n      },\n      hasExploredExperiences: {\n        $sum: {\n          $cond: [\n            {\n              $and: [\n                { $eq: [\"$event_type\", 100008] },\n                { $gt: [\"$experience_count\", 0] }\n              ]\n            },\n            1,\n            0\n          ]\n        }\n      }\n    }\n  },\n  {\n    $group: {\n      _id: null,\n      usersCreated: {\n        $sum: {\n          $cond: [{ $gt: [\"$hasUserCreatedEvent\", 0] }, 1, 0]\n        }\n      },\n      usersWithExperienceExplored: {\n        $sum: {\n          $cond: [{ $gt: [\"$hasExploredExperiences\", 0] }, 1, 0]\n        }\n      }\n    }\n  }\n]","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-11":{"title":"Users dropped&nbsp;","description":"before Discovering any Experiences","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"number","itemType":"chart","filters":[],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[{"fieldPath":"droppedBeforeExperience","rawExpression":"{ $subtract: [1, {\n  $divide: ['$usersWithDiscoveredExperience', '$usersCreated']\n}]}\n\n","derivedMQL":"{\"$subtract\":[1,{\"$divide\":[\"$usersWithDiscoveredExperience\",\"$usersCreated\"]}]}"}],"channels":{"value":{"field":"droppedBeforeExperience","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"}},"reductions":{},"customisations":{"options":{},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Percentage"},"numberDecimals":{"enabled":true,"value":"2"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}}},"conditionalFormatting":[{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_GREATER_THAN","value":"0.1"}],"applyToEntireRow":false,"styling":{"color":"rgb(193, 4, 34)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}},{"type":"discrete","conditions":[{"target":{"value":"value","type":"CHANNEL"},"operator":"NUMBER_LESS_THAN","value":"0.05"}],"applyToEntireRow":false,"styling":{"color":"rgb(22, 204, 98)","backgroundColor":"rgba(0, 0, 0, 0)","fontStyle":"normal","fontWeight":"normal","textDecoration":"initial"}}]},"chartType":"Number","meta":{},"sample":false,"query":"[\n  {\n    $match: {\n      event_type: { $in: [100001, 100007] }\n    }\n  },\n  {\n    $group: {\n      _id: \"$anonymized_user_id\",\n      hasUserCreatedEvent: {\n        $sum: {\n          $cond: [{ $eq: [\"$event_type\", 100001] }, 1, 0]\n        }\n      },\n      hasDiscoveredExperiences: {\n        $sum: {\n          $cond: [\n            {\n              $and: [\n                { $eq: [\"$event_type\", 100007] },\n                { $gt: [\"$experience_count\", 0] }\n              ]\n            },\n            1,\n            0\n          ]\n        }\n      }\n    }\n  },\n  {\n    $group: {\n      _id: null,\n      usersCreated: {\n        $sum: {\n          $cond: [{ $gt: [\"$hasUserCreatedEvent\", 0] }, 1, 0]\n        }\n      },\n      usersWithDiscoveredExperience: {\n        $sum: {\n          $cond: [{ $gt: [\"$hasDiscoveredExperiences\", 0] }, 1, 0]\n        }\n      }\n    }\n  }\n]","queryId":null,"interactiveFiltering":"filter","embedding":{}},"item-14":{"title":"Drop-off breakdown by Conversation Phase (percentage)","description":"Percentage of users who started a conversation, broken down by the phase where they dropped off.&nbsp;","dashboardId":"dashboard-1","dataSourceId":"data-source-1","iconValue":"combo-stacked","itemType":"chart","filters":[{"fieldPath":"phase","disabled":false,"type":"String","settings":{"allOthers":true,"values":[]}}],"missedFields":[],"lookupFields":[],"convertedFields":[],"calculatedFields":[{"fieldPath":"phase_label_ordered","rawExpression":"{\n  $switch: {\n    branches: [\n      { case: { $eq: [\"$phase\", \"INTRO\"] }, then: \"1_INTRO\" },\n      { case: { $eq: [\"$phase\", \"COLLECT_EXPERIENCES\"] }, then: \"2_COLLECT_EXPERIENCES\" },\n      { case: { $eq: [\"$phase\", \"DIVE_IN\"] }, then: \"3_DIVE_IN\" },\n      { case: { $eq: [\"$phase\", \"ENDED\"] }, then: \"4_ENDED\" }\n    ],\n    default: \"0_UNKNOWN\"\n  }\n}\n","derivedMQL":"{\"$switch\":{\"branches\":[{\"case\":{\"$eq\":[\"$phase\",\"INTRO\"]},\"then\":\"1_INTRO\"},{\"case\":{\"$eq\":[\"$phase\",\"COLLECT_EXPERIENCES\"]},\"then\":\"2_COLLECT_EXPERIENCES\"},{\"case\":{\"$eq\":[\"$phase\",\"DIVE_IN\"]},\"then\":\"3_DIVE_IN\"},{\"case\":{\"$eq\":[\"$phase\",\"ENDED\"]},\"then\":\"4_ENDED\"}],\"default\":\"0_UNKNOWN\"}}"}],"channels":{"y":{"field":"ENDED","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"x":{"field":"timestamp","type":"nominal","inferredType":"Date","channelType":"category","isBinning":true,"temporalBinning":["year","month","date"]},"y_series_0":{"field":"DIVE_IN","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"ylines":{"field":"_DROPOUT","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"y_series_1":{"field":"COLLECT_EXPERIENCES","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"},"y_series_2":{"field":"INTRO","type":"quantitative","inferredType":"Number","channelType":"aggregation","aggregate":"sum"}},"reductions":{},"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":{"range":["#16cc62","#196ee6","#e6b219","#e6196e","#000000"],"domain":["y","y_series_0","y_series_1","y_series_2","ylines"]}},"dashStyles":{"enabled":true,"value":null},"lineSmoothing":{"enabled":true,"value":"monotone"},"dataMarkers":{"enabled":true,"value":null},"labelSize":{"enabled":true,"value":"120"}},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"diagonal"}},"y":{"labelOverride":{"enabled":true,"value":"Percentage"}}},"channels":{"y":{"labelOverride":{"enabled":true,"value":"ENDED"},"numberFormatting":{"enabled":true,"value":"Custom"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}},"x":{"labelOverride":{"enabled":true,"value":"Date"},"datePreset":{"enabled":true,"value":"Custom"},"dateTimeFormatting":{"enabled":true,"value":"ddd-DD-MMM"}},"y_series_0":{"labelOverride":{"enabled":true,"value":"DIVE_IN"},"numberFormatting":{"enabled":true,"value":"Custom"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}},"ylines":{"labelOverride":{"enabled":true,"value":"users who started but didnâ€™t finish"},"numberFormatting":{"enabled":true,"value":"Custom"},"numberDecimals":{"enabled":true,"value":"2"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}},"y_series_1":{"labelOverride":{"enabled":true,"value":"COLLECT_EXPERIENCES"},"numberFormatting":{"enabled":true,"value":"Custom"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}},"y_series_2":{"labelOverride":{"enabled":true,"value":"INTRO"},"numberFormatting":{"enabled":true,"value":"Custom"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}}},"conditionalFormatting":[]},"chartType":"Stacked Combo","meta":{},"sample":false,"query":"[\n  {\n    $match: {\n      event_type: 100002,\n      phase: { $in: [\"INTRO\", \"COLLECT_EXPERIENCES\", \"DIVE_IN\", \"ENDED\"] }\n    }\n  },\n  {\n    $addFields: {\n      date: { $dateTrunc: { date: \"$timestamp\", unit: \"day\" } },\n      phaseOrder: {\n        $switch: {\n          branches: [\n            { case: { $eq: [\"$phase\", \"INTRO\"] }, then: 1 },\n            { case: { $eq: [\"$phase\", \"COLLECT_EXPERIENCES\"] }, then: 2 },\n            { case: { $eq: [\"$phase\", \"DIVE_IN\"] }, then: 3 },\n            { case: { $eq: [\"$phase\", \"ENDED\"] }, then: 4 }\n          ],\n          default: 99\n        }\n      }\n    }\n  },\n  {\n    $sort: {\n      anonymized_user_id: 1,\n      date: 1,\n      phaseOrder: -1\n    }\n  },\n  {\n    $group: {\n      _id: {\n        session: \"$anonymized_session_id\",\n        date: \"$date\"\n      },\n      lastPhase: { $first: \"$phase\" }\n    }\n  },\n  {\n    $addFields: {\n      phase_label_ordered: {\n        $switch: {\n          branches: [\n            { case: { $eq: [\"$lastPhase\", \"INTRO\"] }, then: \"4_INTRO\" },\n            {\n              case: { $eq: [\"$lastPhase\", \"COLLECT_EXPERIENCES\"] },\n              then: \"3_COLLECT_EXPERIENCES\"\n            },\n            { case: { $eq: [\"$lastPhase\", \"DIVE_IN\"] }, then: \"2_DIVE_IN\" },\n            { case: { $eq: [\"$lastPhase\", \"ENDED\"] }, then: \"1_ENDED\" }\n          ],\n          default: \"0_UNKNOWN\"\n        }\n      }\n    }\n  },\n  {\n    $group: {\n      _id: {\n        date: \"$_id.date\",\n        phase: \"$phase_label_ordered\"\n      },\n      sessionCount: { $sum: 1 }\n    }\n  },\n  {\n    $group: {\n      _id: \"$_id.date\",\n      phases: {\n        $push: {\n          k: \"$_id.phase\",\n          v: \"$sessionCount\"\n        }\n      }\n    }\n  },\n  {\n    $addFields: {\n      phaseCounts: {\n        $arrayToObject: \"$phases\"\n      }\n    }\n  },\n  {\n    $addFields: {\n      total: {\n        $reduce: {\n          input: { $objectToArray: \"$phaseCounts\" },\n          initialValue: 0,\n          in: { $add: [\"$$value\", \"$$this.v\"] }\n        }\n      }\n    }\n  },\n  {\n    $project: {\n      timestamp: \"$_id\",\n      INTRO: {\n        $cond: [\n          { $eq: [\"$total\", 0] },\n          0,\n          {\n            $round: [\n              { $divide: [{ $ifNull: [\"$phaseCounts.4_INTRO\", 0] }, \"$total\"] },\n              4\n            ]\n          }\n        ]\n      },\n      COLLECT_EXPERIENCES: {\n        $cond: [\n          { $eq: [\"$total\", 0] },\n          0,\n          {\n            $round: [\n              {\n                $divide: [\n                  { $ifNull: [\"$phaseCounts.3_COLLECT_EXPERIENCES\", 0] },\n                  \"$total\"\n                ]\n              },\n              4\n            ]\n          }\n        ]\n      },\n      DIVE_IN: {\n        $cond: [\n          { $eq: [\"$total\", 0] },\n          0,\n          {\n            $round: [\n              {\n                $divide: [{ $ifNull: [\"$phaseCounts.2_DIVE_IN\", 0] }, \"$total\"]\n              },\n              4\n            ]\n          }\n        ]\n      },\n      ENDED: {\n        $cond: [\n          { $eq: [\"$total\", 0] },\n          0,\n          {\n            $round: [\n              { $divide: [{ $ifNull: [\"$phaseCounts.1_ENDED\", 0] }, \"$total\"] },\n              4\n            ]\n          } // round to the nearest ten thousandths so that we can multiplu it by 100 later\n        ]\n      },\n      _DROPOUT: {\n        $cond: [\n          { $eq: [\"$total\", 0] },\n          0,\n          {\n            $round: [\n              {\n                $subtract: [\n                  1,\n                  {\n                    $divide: [\n                      { $ifNull: [\"$phaseCounts.1_ENDED\", 0] },\n                      \"$total\"\n                    ]\n                  }\n                ]\n              },\n              2\n            ]\n          }\n        ]\n      }\n    }\n  },\n  {\n    $sort: { timestamp: 1 }\n  }\n]","queryId":null,"interactiveFiltering":"filter","embedding":{}}},"dataSources":{"data-source-1":{"alias":"metric_events","collection":"metric_events","database":"compass-application-ajira","deployment":"Ajira","sourceType":"cluster"}},"queries":{}}